<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/..\FrameXML\UI.xsd">
    <Script file="src/bank/BankFrame.lua"/>
    <Script file="src/bank/Bank.lua"/>
    <Script file="src/bank/BankTabSettingsMenu.lua"/>

    <Frame name="DJBagsBankBar" inherits="DJBagsBackgroundTemplate" parent="UIParent" movable="true" enableMouse="true" hidden="true">
        <Size x="323" y="85" />
        <Anchors>
            <Anchor point="TOPLEFT" x="150" y="-100" />
        </Anchors>
        <Frames>
            <Frame name="DJBagsBank" inherits="DJBagsBackgroundTemplate" parentKey="bankBag" frameStrata="MEDIUM" toplevel="true" movable="true" enableMouse="true" hidden="true" parent="DJBagsBankBar">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parent" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsRegisterBankBagContainer(self, {
                                Enum.BagIndex.CharacterBankTab_1,
                                Enum.BagIndex.CharacterBankTab_2,
                                Enum.BagIndex.CharacterBankTab_3,
                                Enum.BagIndex.CharacterBankTab_4,
                                Enum.BagIndex.CharacterBankTab_5,
                                Enum.BagIndex.CharacterBankTab_6}, Enum.BankType.Character)
                    </OnLoad>
                    <OnShow>
                        self:OnShow()
                    </OnShow>
                    <OnHide>
                        self:OnHide()
                    </OnHide>
                </Scripts>
            </Frame>
            <Frame name="DJBagsWarbandBank" inherits="DJBagsBackgroundTemplate" parentKey="warbandBankBag" frameStrata="MEDIUM" toplevel="true" movable="true" enableMouse="true" hidden="true" parent="DJBagsBankBar">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parent" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsRegisterBankBagContainer(self, {
                                Enum.BagIndex.AccountBankTab_1,
                                Enum.BagIndex.AccountBankTab_2,
                                Enum.BagIndex.AccountBankTab_3,
                                Enum.BagIndex.AccountBankTab_4,
                                Enum.BagIndex.AccountBankTab_5,
                                Enum.BagIndex.AccountBankTab_6}, Enum.BankType.Account)
                    </OnLoad>
                    <OnShow>
                        self:OnShow()
                    </OnShow>
                    <OnHide>
                        self:OnHide()
                    </OnHide>
                </Scripts>
            </Frame>
            <ItemButton name="$parentBag1" parentKey="bag1">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="DJBagsBank" relativePoint="TOPRIGHT" x="5" y="0" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.CharacterBankTab_1, BankButtonIDToInvSlotID(1, 1))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentBag2" parentKey="bag2">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentBag1" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.CharacterBankTab_2, BankButtonIDToInvSlotID(2, 1))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentBag3" parentKey="bag3">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentBag2" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.CharacterBankTab_3, BankButtonIDToInvSlotID(3, 1))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentBag4" parentKey="bag4">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentBag3" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.CharacterBankTab_4, BankButtonIDToInvSlotID(4, 1))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentBag5" parentKey="bag5">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentBag4" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.CharacterBankTab_5, BankButtonIDToInvSlotID(5, 1))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentBag6" parentKey="bag6">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentBag5" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.CharacterBankTab_6, BankButtonIDToInvSlotID(6, 1))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentAccountBag1" parentKey="accountBag1" hidden="true">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="DJBagsWarbandBank" relativePoint="TOPRIGHT" x="5" y="0" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.AccountBankTab_1, BankButtonIDToInvSlotID(1, Enum.BankType and Enum.BankType.Account or 0))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentAccountBag2" parentKey="accountBag2" hidden="true">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentAccountBag1" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.AccountBankTab_2, BankButtonIDToInvSlotID(2, Enum.BankType and Enum.BankType.Account or 0))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentAccountBag3" parentKey="accountBag3" hidden="true">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentAccountBag2" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.AccountBankTab_3, BankButtonIDToInvSlotID(3, Enum.BankType and Enum.BankType.Account or 0))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentAccountBag4" parentKey="accountBag4" hidden="true">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentAccountBag3" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.AccountBankTab_4, BankButtonIDToInvSlotID(4, Enum.BankType and Enum.BankType.Account or 0))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentAccountBag5" parentKey="accountBag5" hidden="true">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentAccountBag4" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.AccountBankTab_5, BankButtonIDToInvSlotID(5, Enum.BankType and Enum.BankType.Account or 0))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <ItemButton name="$parentAccountBag6" parentKey="accountBag6" hidden="true">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentAccountBag5" relativePoint="BOTTOMLEFT" y="-5" />
                </Anchors>
                <Scripts>
                    <OnLoad>
                        DJBagsBagItemLoad(self, Enum.BagIndex.AccountBankTab_6, BankButtonIDToInvSlotID(6, Enum.BankType and Enum.BankType.Account or 0))
                    </OnLoad>
                </Scripts>
            </ItemButton>
            <Button name="$parentRestackButton">
                <Size x="16" y="16" />
                <Anchors>
                    <Anchor point="TOPRIGHT" x="-9" y="-9" />
                </Anchors>
                <NormalTexture file="Interface\Buttons\UI-GuildButton-PublicNote-Disabled" />
                <PushedTexture file="Interface\Buttons\UI-GuildButton-OfficerNote-Up" />
                <HighlightTexture file="Interface\Buttons\UI-GuildButton-PublicNote-Up" alphaMode="ADD" />
                <Scripts>
                    <OnEnter>
                        GameTooltip:SetOwner(self, 'TOPRIGHT')
                        GameTooltip:SetText(BAG_CLEANUP_BANK)
                        GameTooltip:Show()
                    </OnEnter>
                    <OnLeave>
                        GameTooltip:Hide()
                    </OnLeave>
                    <OnClick>
                        if C_Container and C_Container.SortBankBags then
                            C_Container.SortBankBags()
                        elseif SortBankBags then
                            SortBankBags()
                        end
                    </OnClick>
                </Scripts>
            </Button>
            <Button name="$parentSettingsBtn">
                <Size x="16" y="16"/>
                <Anchors>
                    <Anchor point="TOPLEFT" x="9" y="-9"/>
                </Anchors>
                <NormalTexture file="Interface\Buttons\UI-GuildButton-PublicNote-Disabled"/>
                <PushedTexture file="Interface\Buttons\UI-GuildButton-OfficerNote-Up"/>
                <HighlightTexture file="Interface\Buttons\UI-GuildButton-PublicNote-Up" alphaMode="ADD"/>
                <Scripts>
                    <OnEnter>
                        GameTooltip:SetOwner(self, 'TOPRIGHT')
                        GameTooltip:SetText(SETTINGS)
                        GameTooltip:Show()
                    </OnEnter>
                    <OnLeave>
                        GameTooltip:Hide()
                    </OnLeave>
                    <OnClick>
                        if self:GetParent().bankSettingsMenu:IsVisible() then
                            self:GetParent().bankSettingsMenu:Hide()
                        else
                            self:GetParent().bankSettingsMenu:Show()
                        end
                    </OnClick>
                </Scripts>
            </Button>
            <EditBox name="$parentSearchBar" inherits="BagSearchBoxTemplate">
                <Size y="25" />
                <Anchors>
                    <Anchor point="LEFT" relativeTo="$parentSettingsBtn" relativePoint="RIGHT" x="5"/>
                    <Anchor point="RIGHT" relativeTo="$parentRestackButton" relativePoint="LEFT" x="-5" />
                </Anchors>
            </EditBox>
            <Button name="$parentClose" parentKey="close" inherits="UIPanelCloseButton">
                <Anchors>
                    <Anchor point="CENTER" relativePoint="TOPRIGHT" x="-2" y="-2"/>
                </Anchors>
                <NormalTexture file="Interface\Buttons\UI-Panel-MinimizeButton-Disabled" />
                <Scripts>
                    <OnLoad>
                        self:SetAlpha(0.2)
                    </OnLoad>
                    <OnEnter>
                        self:SetAlpha(1)
                    </OnEnter>
                    <OnLeave>
                        self:SetAlpha(0.2)
                    </OnLeave>
                </Scripts>
            </Button>
            <Frame name="$parentSettingsBank" parentKey="bankSettingsMenu" inherits="DJBagsSettings" hidden="true">
                <Anchors>
                    <Anchor point="TOPRIGHT" relativeTo="$parent" relativePoint="TOPLEFT" />
                </Anchors>
                <Layers>
                    <Layer level="OVERLAY">
                        <FontString name="$parentName" parentKey="name" inherits="GameFontHighlight" text="BANK">
                            <Anchors>
                                <Anchor point="TOPLEFT">
                                    <Offset>
                                        <AbsDimension x="0" y="10"/>
                                    </Offset>
                                </Anchor>
                                <Anchor point="TOPRIGHT">
                                    <Offset>
                                        <AbsDimension x="0" y="10"/>
                                    </Offset>
                                </Anchor>
                            </Anchors>
                        </FontString>
                    </Layer>
                </Layers>
                <Scripts>

                    <OnLoad>
                        self.bag = self:GetParent().bankBag
                    </OnLoad>
                </Scripts>
            </Frame>
            <Button name="$parentTab1" parentKey="characterTab" inherits="PanelTabButtonTemplate" id="1">
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="DJBagsBank" relativePoint="BOTTOMLEFT" x="2" y="2"/>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        self:SetText(CHARACTER)
                        if not self.Text and self.GetFontString then
                            self.Text = self:GetFontString()
                        end
                        if not self.Left and self.LeftDisabled then
                            self.Left = self.LeftDisabled
                            self.Middle = self.MiddleDisabled
                            self.Right = self.RightDisabled
                        end
                        if self.Left then
                            PanelTemplates_TabResize(self, 0)
                        end
                    </OnLoad>
                    <OnClick>
                        PanelTemplates_SetTab(self:GetParent(), 1)
                        BankFrame:SetTab(1, Enum.BankType and Enum.BankType.Character)
                    </OnClick>
                </Scripts>
            </Button>
            <Button name="$parentTab2" parentKey="warbandTab" inherits="PanelTabButtonTemplate" id="2">
                <Anchors>
                    <Anchor point="LEFT" relativeTo="$parentTab1" relativePoint="RIGHT" x="-16"/>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        self:SetText(WARBAND_BANK or "Warband")
                        if not self.Text and self.GetFontString then
                            self.Text = self:GetFontString()
                        end
                        if not self.Left and self.LeftDisabled then
                            self.Left = self.LeftDisabled
                            self.Middle = self.MiddleDisabled
                            self.Right = self.RightDisabled
                        end
                        if self.Left then
                            PanelTemplates_TabResize(self, 0)
                        end
                    </OnLoad>
                    <OnClick>
                        PanelTemplates_SetTab(self:GetParent(), 2)
                        BankFrame:SetTab(2, Enum.BankType and Enum.BankType.Account)
                    </OnClick>
                </Scripts>
            </Button>
        </Frames>
        <Scripts>
            <OnLoad>
                DJBagsRegisterBankFrame(self)
            </OnLoad>
            <OnShow>
                if OpenBankFrame and not BankFrame:IsShown() then
                    OpenBankFrame()
                end
                if BankFrame:IsShown() then
                    DJBagsHideBlizzardBank()
                end
            </OnShow>
            <OnHide>
                if CloseBankFrame then
                    CloseBankFrame()
                elseif CloseBank then
                    CloseBank()
                end
                StaticPopup_Hide("CONFIRM_BUY_BANK_SLOT")
            </OnHide>
        </Scripts>
    </Frame>
</Ui>


